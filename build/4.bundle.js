(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{50:function(t,e,n){var o=n(4),a=n(51);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[t.i,a,""]]);var r={insert:"head",singleton:!1};o(a,r);t.exports=a.locals||{}},51:function(t,e,n){(e=n(5)(!1)).push([t.i,'body{overscroll-behavior:contain;overflow:hidden}img:press{outline:none}.map-page{width:100vw}.map-container{width:100%;height:100%}.map-top{position:fixed;display:grid;grid-template-columns:auto 50px;top:10px;width:95%;max-width:600px;height:50px;background-color:white;border-radius:5px;left:50%;transform:translate(-50%);box-shadow:0 2px 4px 2px rgba(0,0,0,0.4)}.map-top-search{outline:none;padding-left:17px;border:none;border-radius:5px}.map-top-findme{justify-self:center;align-self:center}.map-radius-icon{position:absolute;right:10px;top:80px;width:40px;height:40px;background-color:salmon;z-index:2;border-radius:5px;box-shadow:0 2px 4px 2px rgba(0,0,0,0.4)}.map-radius-con{position:absolute;display:grid;grid-template-columns:1fr;justify-items:center;vertical-align:center;top:80px;width:95%;max-width:600px;height:100px;font-size:larger;font-weight:bold;background-color:white;box-sizing:border-box;padding:20px;border-radius:5px;left:50%;transform:translate(-50%);box-shadow:0 2px 4px 2px rgba(0,0,0,0.4);z-index:4}.map-radius-con input{width:80%}.map-radius-bg{position:fixed;left:0;right:0;top:0;bottom:0;z-index:3}.map-bottom{position:fixed;bottom:20px;width:100%;height:200px;background-color:white;border-radius:15px 15px 0 0;transform:translate3d(0, 100%, 0);padding:30px;box-sizing:border-box;box-shadow:0 0 4px 4px rgba(0,0,0,0.3)}.map-bottom-body{width:100%;margin-bottom:15px;background-color:#0288d1;border-radius:3px;padding:10px;box-sizing:border-box;font-size:larger;color:white}.map-bottom-nopick{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);text-align:center;background-color:white;color:black;font-size:xx-large}.map-bottom-odp{text-align:center}.map-nearest{position:absolute;top:-52px;left:8px;background-color:white;border-radius:4px;padding:10px;box-shadow:0 2px 4px 2px rgba(0,0,0,0.4)}.gm-style-cc{display:none !important}.gm-style a[href^="https://maps.google.com/maps"]{display:none !important}\n',""]),t.exports=e},55:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),r=n(15),i=n.n(r),s=n(24),c=n.n(s),l=(n(50),n.p+"src/images/my_location.png");function p(t,e,n,o,a,r,i){try{var s=t[r](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(o,a)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var r=t.apply(e,n);function i(t){p(r,o,a,i,s,"next",t)}function s(t){p(r,o,a,i,s,"throw",t)}i(void 0)}))}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],o=!0,a=!1,r=void 0;try{for(var i,s=t[Symbol.iterator]();!(o=(i=s.next()).done)&&(n.push(i.value),!e||n.length!==e);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(a)throw r}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var g=c()(i.a),f=c()(i.a),b={lat:-6.2088,lng:106.8456};function w(t){return t.toLowerCase().split(" ").map((function(t){return t.replace(t[0],t[0].toUpperCase())})).join(" ")}e.default=function(){var t,e,n,r,s,c,p,m,h=Object(o.useRef)(),v=Object(o.useRef)(),x=Object(o.useRef)(),y=Object(o.useRef)(),k=u(Object(o.useState)(""),2),E=k[0],O=k[1],C=u(Object(o.useState)("No location selected."),2),D=C[0],S=C[1],j=u(Object(o.useState)(!0),2),M=j[0],F=j[1],N=u(Object(o.useState)(""),2),L=N[0],P=N[1],T=u(Object(o.useState)(0),2),W=T[0],I=T[1],R=u(Object(o.useState)("200"),2),A=R[0],z=R[1],K=u(Object(o.useState)(!1),2),_=K[0],H=K[1],Z=u(Object(o.useState)(!1),2),B=Z[0],G=Z[1],J=u(Object(o.useState)(0),2),U=J[0],Y=J[1],V=[];Object(o.useEffect)((function(){var o=document.createElement("script");o.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyCXU3EeZo0yexMDnmkigGJJvTvcVDpgPl0","&libraries=places,geometry"),window.document.body.appendChild(o),o.addEventListener("load",d(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t=new window.google.maps.Map(h.current,{zoom:15,center:b,clickableIcons:!1,disableDefaultUI:!0,gestureHandling:"greedy",mapTypeControlOptions:{position:window.google.maps.ControlPosition.BOTTOM_CENTER}}),e=new window.google.maps.Marker({map:t,visible:!1}),(s=new window.google.maps.places.Autocomplete(v.current,{fields:["geometry","name"],types:["geocode"],componentRestrictions:{country:["id"]}})).bindTo("bounds",t),n=new window.google.maps.Circle({map:t,strokeColor:"#FF0000",strokeOpacity:0,strokeWeight:0,fillColor:"#FF0000",fillOpacity:.2,clickable:!1}),r=new window.google.maps.Polygon({map:t,paths:[],strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:2,fillOpacity:0,clickable:!1}),c=new window.google.maps.DirectionsService,p=new window.google.maps.DirectionsRenderer({suppressMarkers:!0,preserveViewport:!0}),m=new window.google.maps.DistanceMatrixService,$();case 10:case"end":return o.stop()}}),o)}))))}),[]);var q=function(o,a){V.map((function(t){return t.setMap(null)})),p&&p.setMap(null),e.setPosition({lat:o,lng:a}),e.setVisible(!0),r.setMap(null),t.panTo({lat:o,lng:a}),n.setMap(null),n.setMap(t),n.setCenter({lat:o,lng:a}),n.setRadius(parseFloat(y.current.value)),F(!0),S("Fetching data..."),g({url:"https://siis-api.udata.id/point_kelurahan/".concat(a,",").concat(o)}).then((function(e){var n=e.data.data[0],i=n.provinsi,s=n.kabupaten,c=n.kecamatan,l=n.kelurahan,p=n.shape.slice(11,-2).split(", ").map((function(t){var e=t.split(" ");return{lat:parseFloat(e[1]),lng:parseFloat(e[0])}}));r.setPath(p),r.setMap(t);var d="KOTA"===s.split(" ")[0]?s.replace("KOTA ",""):s,u="Kel. ".concat(w(l),", Kec. ").concat(w(c),", ").concat(d?"Kota":"Kab."," ").concat(w(d),", ").concat(w(i).replace("Dki","DKI"));F(!1),O(u),P("Fetching ODP data..."),x.current.style.transition=".3s",x.current.style.bottom="200px",G(!0),Q(o,a)})).catch((function(t){i.a.isCancel(t)||(console.log(t),S("Fetching failed!"))}))},Q=function(n,o){f({url:"http://digitasi-consumer-siis-dev.vsan-apps.playcourt.id/api/siis/v1/get-odp",method:"post",data:{lat:n,long:o,radius:y.current.value},auth:{username:"telkom",password:"da1c25d8-37c8-41b1-afe2-42dd4825bfea"}}).then((function(a){var r=a.data.data.features.filter((function(t){return t.attributes.portidlenumber>0})),i=0;if(r.length){var s=r.map((function(t){return t.attributes.deviceportnumber})).reduce((function(t,e){return t+e})),l=r.map((function(t){return t.attributes.portidlenumber})).reduce((function(t,e){return t+e}));i=parseFloat((l/s*100).toFixed(1))}P("".concat(r.length," ODP found (").concat(i,"%)")),V=[],t.setCenter({lat:n,lng:o}),r.length&&(parseFloat(y.current.value)<=150?t.setZoom(18):parseFloat(y.current.value)>=250?t.setZoom(16):t.setZoom(17)),"true"===x.current.dataset.show&&t.panBy(0,70),r.forEach((function(a,r){var i,s=a.attributes;switch(s.status_occ_add){case"RED":i="red";break;case"YELLOW":i="yellow";break;case"GREEN":i="green";break;default:i="black"}V.push(new window.google.maps.Marker({map:t,position:{lat:s.lat,lng:s.long},icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:6,fillColor:i,fillOpacity:.9,strokeWeight:0}})),V[r].latlng={lat:s.lat,lng:s.long},V[r].index=r,V[r].distance=window.google.maps.geometry.spherical.computeDistanceBetween(e.getPosition(),V[r].getPosition()),V[r].infoWindow=new window.google.maps.InfoWindow({content:"<div>\n\t\t\t\t\t\t<span>Latitude: ".concat(s.lat,"</span><br/>\n\t\t\t\t\t\t<span>Longitude: ").concat(s.long,"</span><br/>\n\t\t\t\t\t\t<span>Device ID: ").concat(s.device_id,"</span><br/>\n\t\t\t\t\t\t<span>Device name: ").concat(s.devicename,"</span><br/>\n\t\t\t\t\t\t<span>Status: ").concat(s.status_occ_add,"</span><br/>\n\t\t\t\t\t\t<span>Port number: ").concat(s.deviceportnumber,"</span><br/>\n\t\t\t\t\t\t<span>Idle port: ").concat(s.portidlenumber,"</span>\n\t\t\t\t\t</div>")}),V[r].addListener("mouseover",(function(){V.map((function(t){var e;t.infoWindow.close(),null===(e=t.infoDistance)||void 0===e||e.close()})),V[r].infoWindow.open(t,V[r]),Y(1)})),V[r].addListener("mouseout",(function(){V[r].infoWindow.close()})),V[r].addListener("click",(function(){V.map((function(t){var e;t.infoWindow.close(),null===(e=t.infoDistance)||void 0===e||e.close()})),Y(1),V[r].infoWindow.open(t,V[r]),c.route({origin:"".concat(n,",").concat(o),destination:"".concat(s.lat,",").concat(s.long),travelMode:"WALKING"},(function(e,n){"OK"===n?(console.log(e),p.setMap(t),p.setDirections(e)):window.alert("Directions request failed due to "+n)}))}))}));var d=V.map((function(t){return{distance:t.distance,index:t.index,latlng:t.latlng}})).sort((function(t,e){return t.distance-e.distance})).filter((function(t,e){return e<3}));X(d)})).catch((function(t){i.a.isCancel(t)||(console.log(t),P("Fetching ODP failed!"))}))},X=function(n){m.getDistanceMatrix({origins:[e.getPosition()],destinations:n.map((function(t){return new window.google.maps.LatLng(t.latlng.lat,t.latlng.lng)})),travelMode:"WALKING"},(function(e,o){"OK"===o?(Y(2),n.forEach((function(o,a){V[n[a].index].infoDistance=new window.google.maps.InfoWindow({content:"<div>\n\t\t\t\t\t\t\t<span>".concat(e.rows[0].elements[a].distance.value," m</span>\n\t\t\t\t\t\t</div>")}),V[n[a].index].infoDistance.open(t,V[n[a].index])}))):window.alert("Distances request failed due to "+o)}))},$=function(){window.google.maps.event.addListener(s,"place_changed",(function(){var e=s.getPlace();if(e.geometry){var n=e.geometry,o=n.location;n.viewport?t.fitBounds(e.geometry.viewport):(t.setCenter(e.geometry.location),t.setZoom(16)),q(o.lat(),o.lng())}else alert("Quota exceeded!")}));var e=document.getElementsByClassName("map-nearest")[0];window.google.maps.event.addDomListener(e,"click",(function(){"1"===e.dataset.nearest?(V.map((function(e,n){var o;null===(o=e.infoDistance)||void 0===o||o.open(t,V[n]),e.infoWindow.setMap(null)})),Y(2)):(V.map((function(t){var e;null===(e=t.infoDistance)||void 0===e||e.close()})),Y(1))})),t.addListener("click",(function(t){v.current&&(v.current.value=""),q(t.latLng.lat(),t.latLng.lng())}))};return a.a.createElement("div",{className:"map-page",style:{height:window.innerHeight}},a.a.createElement("div",{className:"map-container",ref:h}),a.a.createElement("div",{className:"map-top"},a.a.createElement("input",{placeholder:"Search here...",className:"map-top-search",ref:v}),a.a.createElement("img",{src:l,alt:"find-me",className:"map-top-findme",onClick:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){var n=e.coords;v.current&&(v.current.value="");var o={lat:n.latitude,lng:n.longitude};t.setCenter(o),t.setZoom(17),q(n.latitude,n.longitude)}),(function(){alert("The Geolocation service failed.")})):alert("Your browser doesn't support geolocation.")}})),a.a.createElement("div",{className:"map-radius-icon",onClick:function(){H(!0)}}),_?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"map-radius-bg",onClick:function(){H(!1)}}),a.a.createElement("div",{className:"map-radius-con"},a.a.createElement("span",null,"Radius: ",A),a.a.createElement("input",{type:"range",min:"100",max:"300",step:"25",value:A,onChange:function(t){z(t.target.value)}}))):a.a.createElement(a.a.Fragment,null),a.a.createElement("input",{type:"number",ref:y,value:A,readOnly:!0,style:{display:"none"}}),a.a.createElement("div",{className:"map-bottom",ref:x,"data-show":B,onTouchStart:function(t){I(t.touches[0].clientY)},onTouchMove:function(t){var e=t.changedTouches[0].clientY,n=window.innerHeight-W,o=window.innerHeight-e+n;B&&(n=200-(window.innerHeight-W),o=200-(e-(window.innerHeight-200)-n)),o>200&&(o=200),x.current.style.transition="none",x.current.style.bottom=o+"px"},onTouchEnd:function(){Number(x.current.style.bottom.replace("px",""))>100?(x.current.style.transition=".3s",x.current.style.bottom="200px",G(!0)):(x.current.style.transition=".3s",x.current.style.bottom="20px",G(!1))}},a.a.createElement("div",{className:"map-nearest","data-nearest":U,style:{display:U?"block":"none"}},1===U?"Show nearest":"Hide nearest"),M?a.a.createElement("div",{className:"map-bottom-nopick"},D):a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"map-bottom-data map-bottom-body"},E),a.a.createElement("div",{className:"map-bottom-odp map-bottom-body"},L))))}}}]);
//# sourceMappingURL=4.bundle.js.map