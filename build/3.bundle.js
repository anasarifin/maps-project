(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{15:function(t,n,e){"use strict";n.a=e.p+"src/images/my_location.png"},45:function(t,n,e){var o=e(4),a=e(46);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[t.i,a,""]]);var r={insert:"head",singleton:!1};o(a,r);t.exports=a.locals||{}},46:function(t,n,e){(n=e(5)(!1)).push([t.i,'body {\n\toverscroll-behavior: contain;\n\toverflow: hidden;\n}\nimg:press {\n\toutline: none;\n}\n.map-page {\n\twidth: 100vw;\n}\n.map-container {\n\twidth: 100%;\n\theight: 100%;\n}\n.map-top {\n\tposition: fixed;\n\tdisplay: grid;\n\tgrid-template-columns: auto 50px;\n\ttop: 10px;\n\twidth: 95%;\n\tmax-width: 600px;\n\theight: 50px;\n\tbackground-color: white;\n\tborder-radius: 5px;\n\tleft: 50%;\n\ttransform: translate(-50%);\n\tbox-shadow: 0 2px 4px 2px rgba(0, 0, 0, 0.4);\n}\n.map-top-search {\n\toutline: none;\n\tpadding-left: 17px;\n\tborder: none;\n\tborder-radius: 5px;\n}\n.map-top-findme {\n\tjustify-self: center;\n\talign-self: center;\n}\n.map-radius-icon {\n\tposition: absolute;\n\tright: 10px;\n\ttop: 80px;\n\twidth: 40px;\n\theight: 40px;\n\tbackground-color: salmon;\n\tz-index: 2;\n\tborder-radius: 5px;\n\tbox-shadow: 0 2px 4px 2px rgba(0, 0, 0, 0.4);\n}\n.map-radius-con {\n\tposition: absolute;\n\tdisplay: grid;\n\tgrid-template-columns: 1fr;\n\tjustify-items: center;\n\tvertical-align: center;\n\ttop: 80px;\n\twidth: 95%;\n\tmax-width: 600px;\n\theight: 100px;\n\tfont-size: larger;\n\tfont-weight: bold;\n\tbackground-color: white;\n\tbox-sizing: border-box;\n\tpadding: 20px;\n\tborder-radius: 5px;\n\tleft: 50%;\n\ttransform: translate(-50%);\n\tbox-shadow: 0 2px 4px 2px rgba(0, 0, 0, 0.4);\n\tz-index: 4;\n}\n.map-radius-con input {\n\twidth: 80%;\n}\n.map-radius-bg {\n\tposition: fixed;\n\tleft: 0;\n\tright: 0;\n\ttop: 0;\n\tbottom: 0;\n\tz-index: 3;\n}\n.map-bottom {\n\tposition: fixed;\n\tbottom: 20px;\n\twidth: 100%;\n\theight: 200px;\n\tbackground-color: white;\n\tborder-radius: 15px 15px 0 0;\n\ttransform: translate3d(0, 100%, 0);\n\tpadding: 30px;\n\tbox-sizing: border-box;\n\tbox-shadow: 0 0 4px 4px rgba(0, 0, 0, 0.3);\n}\n.map-bottom-body {\n\twidth: 100%;\n\tmargin-bottom: 15px;\n\tbackground-color: #0288d1;\n\tborder-radius: 3px;\n\tpadding: 10px;\n\tbox-sizing: border-box;\n\tfont-size: larger;\n\tcolor: white;\n}\n.map-bottom-nopick {\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\ttext-align: center;\n\tbackground-color: white;\n\tcolor: black;\n\tfont-size: xx-large;\n}\n.map-bottom-odp {\n\ttext-align: center;\n}\n.map-nearest {\n\tposition: absolute;\n\ttop: -52px;\n\tleft: 8px;\n\tbackground-color: white;\n\tborder-radius: 4px;\n\tpadding: 10px;\n\tbox-shadow: 0 2px 4px 2px rgba(0, 0, 0, 0.4);\n}\n\n.gm-style-cc {\n\tdisplay: none !important;\n}\n.gm-style a[href^="https://maps.google.com/maps"]\n{\n\tdisplay: none !important;\n}\n',""]),t.exports=n},48:function(t,n,e){"use strict";e.r(n);var o=e(0),a=e.n(o),r=e(16),i=e.n(r),s=e(25),c=e.n(s),l=(e(45),e(15));function p(t,n,e,o,a,r,i){try{var s=t[r](i),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(o,a)}function u(t){return function(){var n=this,e=arguments;return new Promise((function(o,a){var r=t.apply(n,e);function i(t){p(r,o,a,i,s,"next",t)}function s(t){p(r,o,a,i,s,"throw",t)}i(void 0)}))}}function d(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],o=!0,a=!1,r=void 0;try{for(var i,s=t[Symbol.iterator]();!(o=(i=s.next()).done)&&(e.push(i.value),!n||e.length!==n);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(a)throw r}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return m(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return m(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}var g=c()(i.a),f=c()(i.a),b={lat:-6.2088,lng:106.8456};function w(t){return t.toLowerCase().split(" ").map((function(t){return t.replace(t[0],t[0].toUpperCase())})).join(" ")}n.default=function(){var t,n,e,r,s,c,p,m,h=Object(o.useRef)(),v=Object(o.useRef)(),x=Object(o.useRef)(),y=Object(o.useRef)(),k=d(Object(o.useState)(""),2),E=k[0],O=k[1],C=d(Object(o.useState)("No location selected."),2),D=C[0],S=C[1],j=d(Object(o.useState)(!0),2),M=j[0],F=j[1],N=d(Object(o.useState)(""),2),L=N[0],P=N[1],T=d(Object(o.useState)(0),2),W=T[0],I=T[1],R=d(Object(o.useState)("200"),2),A=R[0],z=R[1],K=d(Object(o.useState)(!1),2),_=K[0],H=K[1],Z=d(Object(o.useState)(!1),2),B=Z[0],G=Z[1],J=d(Object(o.useState)(0),2),U=J[0],Y=J[1],V=[];Object(o.useEffect)((function(){var o=document.createElement("script");o.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyCXU3EeZo0yexMDnmkigGJJvTvcVDpgPl0","&libraries=places,geometry"),window.document.body.appendChild(o),o.addEventListener("load",u(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t=new window.google.maps.Map(h.current,{zoom:15,center:b,clickableIcons:!1,disableDefaultUI:!0,gestureHandling:"greedy",mapTypeControlOptions:{position:window.google.maps.ControlPosition.BOTTOM_CENTER}}),n=new window.google.maps.Marker({map:t,visible:!1}),(s=new window.google.maps.places.Autocomplete(v.current,{fields:["geometry","name"],types:["geocode"],componentRestrictions:{country:["id"]}})).bindTo("bounds",t),e=new window.google.maps.Circle({map:t,strokeColor:"#FF0000",strokeOpacity:0,strokeWeight:0,fillColor:"#FF0000",fillOpacity:.2,clickable:!1}),r=new window.google.maps.Polygon({map:t,paths:[],strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:2,fillOpacity:0,clickable:!1}),c=new window.google.maps.DirectionsService,p=new window.google.maps.DirectionsRenderer({suppressMarkers:!0,preserveViewport:!0}),m=new window.google.maps.DistanceMatrixService,$();case 10:case"end":return o.stop()}}),o)}))))}),[]);var q=function(o,a){V.map((function(t){return t.setMap(null)})),p&&p.setMap(null),n.setPosition({lat:o,lng:a}),n.setVisible(!0),r.setMap(null),t.panTo({lat:o,lng:a}),e.setMap(null),e.setMap(t),e.setCenter({lat:o,lng:a}),e.setRadius(parseFloat(y.current.value)),F(!0),S("Fetching data..."),g({url:"https://siis-api.udata.id/point_kelurahan/".concat(a,",").concat(o)}).then((function(n){var e=n.data.data[0],i=e.provinsi,s=e.kabupaten,c=e.kecamatan,l=e.kelurahan,p=e.shape.slice(11,-2).split(", ").map((function(t){var n=t.split(" ");return{lat:parseFloat(n[1]),lng:parseFloat(n[0])}}));r.setPath(p),r.setMap(t);var u="KOTA"===s.split(" ")[0]?s.replace("KOTA ",""):s,d="Kel. ".concat(w(l),", Kec. ").concat(w(c),", ").concat(u?"Kota":"Kab."," ").concat(w(u),", ").concat(w(i).replace("Dki","DKI"));F(!1),O(d),P("Fetching ODP data..."),x.current.style.transition=".3s",x.current.style.bottom="200px",G(!0),Q(o,a)})).catch((function(t){i.a.isCancel(t)||(console.log(t),S("Fetching failed!"))}))},Q=function(e,o){f({url:"http://digitasi-consumer-siis-dev.vsan-apps.playcourt.id/api/siis/v1/get-odp",method:"post",data:{lat:e,long:o,radius:y.current.value},auth:{username:"telkom",password:"da1c25d8-37c8-41b1-afe2-42dd4825bfea"}}).then((function(a){var r=a.data.data.features.filter((function(t){return t.attributes.portidlenumber>0})),i=0;if(r.length){var s=r.map((function(t){return t.attributes.deviceportnumber})).reduce((function(t,n){return t+n})),l=r.map((function(t){return t.attributes.portidlenumber})).reduce((function(t,n){return t+n}));i=parseFloat((l/s*100).toFixed(1))}P("".concat(r.length," ODP found (").concat(i,"%)")),V=[],t.setCenter({lat:e,lng:o}),r.length&&(parseFloat(y.current.value)<=150?t.setZoom(18):parseFloat(y.current.value)>=250?t.setZoom(16):t.setZoom(17)),"true"===x.current.dataset.show&&t.panBy(0,70),r.forEach((function(a,r){var i,s=a.attributes;switch(s.status_occ_add){case"RED":i="red";break;case"YELLOW":i="yellow";break;case"GREEN":i="green";break;default:i="black"}V.push(new window.google.maps.Marker({map:t,position:{lat:s.lat,lng:s.long},icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:6,fillColor:i,fillOpacity:.9,strokeWeight:0}})),V[r].latlng={lat:s.lat,lng:s.long},V[r].index=r,V[r].distance=window.google.maps.geometry.spherical.computeDistanceBetween(n.getPosition(),V[r].getPosition()),V[r].infoWindow=new window.google.maps.InfoWindow({content:"<div>\n\t\t\t\t\t\t<span>Latitude: ".concat(s.lat,"</span><br/>\n\t\t\t\t\t\t<span>Longitude: ").concat(s.long,"</span><br/>\n\t\t\t\t\t\t<span>Device ID: ").concat(s.device_id,"</span><br/>\n\t\t\t\t\t\t<span>Device name: ").concat(s.devicename,"</span><br/>\n\t\t\t\t\t\t<span>Status: ").concat(s.status_occ_add,"</span><br/>\n\t\t\t\t\t\t<span>Port number: ").concat(s.deviceportnumber,"</span><br/>\n\t\t\t\t\t\t<span>Idle port: ").concat(s.portidlenumber,"</span>\n\t\t\t\t\t</div>")}),V[r].addListener("mouseover",(function(){V.map((function(t){var n;t.infoWindow.close(),null===(n=t.infoDistance)||void 0===n||n.close()})),V[r].infoWindow.open(t,V[r]),Y(1)})),V[r].addListener("mouseout",(function(){V[r].infoWindow.close()})),V[r].addListener("click",(function(){V.map((function(t){var n;t.infoWindow.close(),null===(n=t.infoDistance)||void 0===n||n.close()})),Y(1),V[r].infoWindow.open(t,V[r]),c.route({origin:"".concat(e,",").concat(o),destination:"".concat(s.lat,",").concat(s.long),travelMode:"WALKING"},(function(n,e){"OK"===e?(p.setMap(t),p.setDirections(n)):window.alert("Directions request failed due to "+e)}))}))}));var u=V.map((function(t){return{distance:t.distance,index:t.index,latlng:t.latlng}})).sort((function(t,n){return t.distance-n.distance})).filter((function(t,n){return n<3}));X(u)})).catch((function(t){i.a.isCancel(t)||(console.log(t),P("Fetching ODP failed!"))}))},X=function(e){m.getDistanceMatrix({origins:[n.getPosition()],destinations:e.map((function(t){return new window.google.maps.LatLng(t.latlng.lat,t.latlng.lng)})),travelMode:"WALKING"},(function(n,o){"OK"===o?(Y(2),e.forEach((function(o,a){V[e[a].index].infoDistance=new window.google.maps.InfoWindow({content:"<div>\n\t\t\t\t\t\t\t<span>".concat(n.rows[0].elements[a].distance.value," m</span>\n\t\t\t\t\t\t</div>")}),V[e[a].index].infoDistance.open(t,V[e[a].index])}))):window.alert("Distances request failed due to "+o)}))},$=function(){window.google.maps.event.addListener(s,"place_changed",(function(){var n=s.getPlace();if(n.geometry){var e=n.geometry,o=e.location;e.viewport?t.fitBounds(n.geometry.viewport):(t.setCenter(n.geometry.location),t.setZoom(16)),q(o.lat(),o.lng())}else alert("Quota exceeded!")}));var n=document.getElementsByClassName("map-nearest")[0];window.google.maps.event.addDomListener(n,"click",(function(){"1"===n.dataset.nearest?(V.map((function(n,e){var o;null===(o=n.infoDistance)||void 0===o||o.open(t,V[e]),n.infoWindow.setMap(null)})),Y(2)):(V.map((function(t){var n;null===(n=t.infoDistance)||void 0===n||n.close()})),Y(1))})),t.addListener("click",(function(t){v.current&&(v.current.value=""),q(t.latLng.lat(),t.latLng.lng())}))};return a.a.createElement("div",{className:"map-page",style:{height:window.innerHeight}},a.a.createElement("div",{className:"map-container",ref:h}),a.a.createElement("div",{className:"map-top"},a.a.createElement("input",{placeholder:"Search here...",className:"map-top-search",ref:v}),a.a.createElement("img",{src:l.a,alt:"find-me",className:"map-top-findme",onClick:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(n){var e=n.coords;v.current&&(v.current.value="");var o={lat:e.latitude,lng:e.longitude};t.setCenter(o),t.setZoom(17),q(e.latitude,e.longitude)}),(function(){alert("The Geolocation service failed.")})):alert("Your browser doesn't support geolocation.")}})),a.a.createElement("div",{className:"map-radius-icon",onClick:function(){H(!0)}}),_?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"map-radius-bg",onClick:function(){H(!1)}}),a.a.createElement("div",{className:"map-radius-con"},a.a.createElement("span",null,"Radius: ",A),a.a.createElement("input",{type:"range",min:"100",max:"300",step:"25",value:A,onChange:function(t){z(t.target.value)}}))):a.a.createElement(a.a.Fragment,null),a.a.createElement("input",{type:"number",ref:y,value:A,readOnly:!0,style:{display:"none"}}),a.a.createElement("div",{className:"map-bottom",ref:x,"data-show":B,onTouchStart:function(t){I(t.touches[0].clientY)},onTouchMove:function(t){var n=t.changedTouches[0].clientY,e=window.innerHeight-W,o=window.innerHeight-n+e;B&&(e=200-(window.innerHeight-W),o=200-(n-(window.innerHeight-200)-e)),o>200&&(o=200),x.current.style.transition="none",x.current.style.bottom=o+"px"},onTouchEnd:function(){Number(x.current.style.bottom.replace("px",""))>100?(x.current.style.transition=".3s",x.current.style.bottom="200px",G(!0)):(x.current.style.transition=".3s",x.current.style.bottom="20px",G(!1))}},a.a.createElement("div",{className:"map-nearest","data-nearest":U,style:{display:U?"block":"none"}},1===U?"Show nearest":"Hide nearest"),M?a.a.createElement("div",{className:"map-bottom-nopick"},D):a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"map-bottom-data map-bottom-body"},E),a.a.createElement("div",{className:"map-bottom-odp map-bottom-body"},L))))}}}]);
//# sourceMappingURL=3.bundle.js.map