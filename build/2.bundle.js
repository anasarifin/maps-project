(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{11:function(t,n,e){"use strict";n.a=e.p+"src/images/my_location.png"},41:function(t,n,e){var a=e(22),o=e(42);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var r={insert:"head",singleton:!1};a(o,r);t.exports=o.locals||{}},42:function(t,n,e){(n=e(23)(!1)).push([t.i,".map-page {\n\twidth: 100vw;\n\theight: 100vh;\n}\n.map-container {\n\twidth: 100%;\n\theight: 100%;\n}\n\n.map-search-bar {\n\tposition: fixed;\n\tmargin-top: 10px;\n\tmargin-left: 10px;\n\tmax-width: 200px;\n\twidth: 70%;\n\theight: max-content;\n\tbackground: white;\n\tborder-radius: 3px;\n}\n.map-search-option {\n\tbox-sizing: border-box;\n\tcursor: pointer;\n\tbackground-color: whitesmoke;\n\tcolor: gray;\n\tdisplay: grid;\n\tgrid-template-columns: 1fr 1fr;\n}\n.map-search-option div {\n\theight: 30px;\n\tline-height: 30px;\n\ttext-align: center;\n}\n.map-search-option div.active {\n\tbackground-color: white;\n\tcolor: black;\n}\n\n#map-search-name {\n\twidth: 100%;\n\tbox-sizing: border-box;\n}\n\n#map-popup {\n\twidth: max-content;\n\theight: max-content;\n}\n#map-popup span {\n\ttext-align: center;\n\tdisplay: block;\n}\n#map-popup-edit {\n\tmargin-top: 5px;\n\tcolor: blue;\n\tcursor: pointer;\n}\n\n#map-form {\n\tdisplay: grid;\n\tgrid-template-columns: 1fr;\n}\n#map-form label {\n\tdisplay: block;\n\tmargin: 5px;\n}\n#map-form button {\n\tmargin-top: 15px;\n}\n\n.map-input-bg {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 0;\n\theight: 0;\n\tbackground-color: rgba(0, 0, 0, 0.5);\n}\n.map-input-bg.show {\n\twidth: 100%;\n\theight: 100%;\n}\n.map-find-me {\n\tposition: fixed;\n\tbackground-color: white;\n\tmargin-right: 12px;\n}\n.map-radius-slider {\n\tbackground-color: white;\n\tposition: fixed;\n\tmargin-top: 10px;\n\tmargin-left: 10px;\n}\n#map-input-form {\n\tposition: fixed;\n\tdisplay: none;\n\tgrid-template-columns: 1fr;\n\tbackground-color: white;\n\tborder-radius: 5px;\n\tpadding: 15px;\n\ttop: 60%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\topacity: 0;\n\ttransition: 0.3s;\n}\n#map-input-form.show {\n\ttop: 50%;\n\topacity: 1;\n}\n#map-input-form input {\n\ttext-transform: uppercase;\n}\n#map-input-form label {\n\tdisplay: block;\n\tmargin: 7px;\n}\n#map-input-form button {\n\tmargin-top: 15px;\n}\n",""]),t.exports=n},45:function(t,n,e){"use strict";e.r(n);var a=e(0),o=e.n(a),r=e(12),i=e.n(r),c=e(21),l=e.n(c),s=(e(41),e(11));function p(t,n,e,a,o,r,i){try{var c=t[r](i),l=c.value}catch(t){return void e(t)}c.done?n(l):Promise.resolve(l).then(a,o)}function u(t){return function(){var n=this,e=arguments;return new Promise((function(a,o){var r=t.apply(n,e);function i(t){p(r,a,o,i,c,"next",t)}function c(t){p(r,a,o,i,c,"throw",t)}i(void 0)}))}}function d(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],a=!0,o=!1,r=void 0;try{for(var i,c=t[Symbol.iterator]();!(a=(i=c.next()).done)&&(e.push(i.value),!n||e.length!==n);a=!0);}catch(t){o=!0,r=t}finally{try{a||null==c.return||c.return()}finally{if(o)throw r}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return m(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return m(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,a=new Array(n);e<n;e++)a[e]=t[e];return a}var g=l()(i.a),f=l()(i.a),v={lat:-6.2088,lng:106.8456};n.default=function(){var t,n,e,r,c,l,p,m,h=Object(a.useRef)(null),b=Object(a.useRef)(null),w=Object(a.useRef)(null),y=Object(a.useRef)(null),k=d(Object(a.useState)(""),2),E=k[0],x=k[1],C=d(Object(a.useState)(""),2),L=C[0],O=C[1],M=d(Object(a.useState)("200"),2),F=M[0],T=M[1],P=d(Object(a.useState)(!0),2),S=P[0],I=P[1],j=[];Object(a.useEffect)((function(){var a=document.createElement("script");a.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyCXU3EeZo0yexMDnmkigGJJvTvcVDpgPl0","&libraries=places,geometry"),window.document.body.appendChild(a),a.addEventListener("load",u(regeneratorRuntime.mark((function a(){var o,i,s,u;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=new window.google.maps.Map(h.current,{zoom:15,center:v,clickableIcons:!1,fullscreenControl:!1,mapTypeControl:!0,gestureHandling:"greedy",mapTypeControlOptions:{position:window.google.maps.ControlPosition.BOTTOM_CENTER}}),n=new window.google.maps.Marker({map:t,draggable:!0,visible:!1}),e=new window.google.maps.InfoWindow,o=document.getElementById("map-search-name"),(l=new window.google.maps.places.Autocomplete(o,{fields:["geometry","name"],types:["geocode"],componentRestrictions:{country:["id"]}})).bindTo("bounds",t),r=new window.google.maps.Circle({map:t,strokeColor:"#FF0000",strokeOpacity:0,strokeWeight:0,fillColor:"#FF0000",fillOpacity:.2,clickable:!1}),c=new window.google.maps.Polygon({map:t,paths:[],strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.1,clickable:!1}),p=new window.google.maps.DirectionsService,m=new window.google.maps.DirectionsRenderer({suppressMarkers:!0,preserveViewport:!0}),i=document.getElementsByClassName("map-search-bar")[0],s=document.getElementsByClassName("map-find-me")[0],u=document.getElementsByClassName("map-radius-slider")[0],t.controls[window.google.maps.ControlPosition.TOP_LEFT].push(i),t.controls[window.google.maps.ControlPosition.RIGHT_BOTTOM].push(s),t.controls[window.google.maps.ControlPosition.TOP_LEFT].push(u),D();case 17:case"end":return a.stop()}}),a)}))))}),[]);var R=function a(o,l){j.map((function(t){return t.setMap(null)})),m&&m.setMap(null),n.setPosition({lat:o,lng:l}),n.setVisible(!0),e.setContent('<div id="map-popup">Fetching data...</div>'),e.open(t,n),c.setMap(null),r.setMap(null),r.setMap(t),r.setCenter({lat:o,lng:l}),r.setRadius(parseFloat(y.current.value)),g({url:"https://siis-api.udata.id/point_kelurahan/".concat(l,",").concat(o)}).then((function(n){var e=n.data.data[0].shape.slice(11,-2).split(", ").map((function(t){var n=t.split(" ");return{lat:parseFloat(n[1]),lng:parseFloat(n[0])}}));c.setPath(e),c.setMap(t);var a=document.getElementById("map-popup");if(a){var r=n.data.data[0],i=r.provinsi,s=r.kabupaten,p=r.kecamatan,u=r.kelurahan,d="\n\t\t\t\t<div>\n\t\t\t\t\t<span>".concat(i,"</span>\n\t\t\t\t\t<span>").concat(s,"</span>\n\t\t\t\t\t<span>").concat(p,"</span>\n\t\t\t\t\t<span>").concat(u,'</span><br/>\n\t\t\t\t\t<span id="map-popup-odp-loading">Fetching ODP data...</span>\n\t\t\t\t</div>');a.innerHTML="",a.insertAdjacentHTML("beforeend",d)}_(o,l)})).catch((function(t){if(!i.a.isCancel(t)){console.log(t);var o=document.getElementById("map-popup");o.innerHTML="",o.insertAdjacentHTML("beforeend",'\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div>Fetching failed !</div>\n\t\t\t\t\t\t<span id="map-popup-edit">Try again...</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t'),document.getElementById("map-popup-edit").addEventListener("click",(function(){e.setContent('<div id="map-popup">Fetching again...</div>');var t=n.getPosition();a(t.lat(),t.lng())}))}}))},_=function(n,a){console.log(y.current.value),f({url:"http://digitasi-consumer-siis-dev.vsan-apps.playcourt.id/api/siis/v1/get-odp",method:"post",data:{lat:n,long:a,radius:y.current.value},auth:{username:"telkom",password:"da1c25d8-37c8-41b1-afe2-42dd4825bfea"}}).then((function(o){var r=o.data.data.features.filter((function(t){return t.attributes.portidlenumber>0})),i=0;if(r.length){var c=r.map((function(t){return t.attributes.deviceportnumber})).reduce((function(t,n){return t+n})),l=r.map((function(t){return t.attributes.portidlenumber})).reduce((function(t,n){return t+n}));i=parseFloat((l/c*100).toFixed(1))}document.getElementById("map-popup-odp-loading").innerHTML="".concat(r.length," ODP found (").concat(i,"%)"),j=[],t.setCenter({lat:n,lng:a}),r.length&&t.setZoom(17),r.forEach((function(o,r){var i,c=o.attributes;switch(c.status_occ_add){case"RED":i="red";break;case"YELLOW":i="yellow";break;case"GREEN":i="green";break;default:i="black"}j.push(new window.google.maps.Marker({map:t,position:{lat:c.lat,lng:c.long},icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:6,fillColor:i,fillOpacity:.9,strokeWeight:0}})),j[r].infoWindow=new window.google.maps.InfoWindow({content:"<div>\n\t\t\t\t\t\t<span>Latitude: ".concat(c.lat,"</span><br/>\n\t\t\t\t\t\t<span>Longitude: ").concat(c.long,"</span><br/>\n\t\t\t\t\t\t<span>Device ID: ").concat(c.device_id,"</span><br/>\n\t\t\t\t\t\t<span>Device name: ").concat(c.devicename,"</span><br/>\n\t\t\t\t\t\t<span>Status: ").concat(c.status_occ_add,"</span><br/>\n\t\t\t\t\t\t<span>Port number: ").concat(c.deviceportnumber,"</span><br/>\n\t\t\t\t\t\t<span>Idle port: ").concat(c.portidlenumber,"</span>\n\t\t\t\t\t</div>")}),j[r].addListener("mouseover",(function(){e.close(),j.map((function(t){return t.infoWindow.close()})),j[r].infoWindow.open(t,j[r])})),j[r].addListener("mouseout",(function(){j[r].infoWindow.close()})),j[r].addListener("click",(function(){e.close(),j.map((function(t){return t.infoWindow.close()})),j[r].infoWindow.open(t,j[r]),p.route({origin:"".concat(n,",").concat(a),destination:"".concat(c.lat,",").concat(c.long),travelMode:"WALKING"},(function(n,e){"OK"===e?(m.setMap(t),m.setDirections(n)):window.alert("Directions request failed due to "+e)}))}))}))})).catch((function(t){i.a.isCancel(t)||(console.log(t),document.getElementById("map-popup-odp-loading").innerHTML="Fetching ODP failed!")}))},D=function(){window.google.maps.event.addListener(l,"place_changed",(function(){var n=l.getPlace();if(n.geometry){var e=n.geometry,a=e.location;e.viewport?t.fitBounds(n.geometry.viewport):(t.setCenter(n.geometry.location),t.setZoom(16)),R(a.lat(),a.lng())}else alert("Quota exceeded!")})),n.addListener("click",(function(){e.getMap()||e.open(t,n)})),n.addListener("mouseover",(function(){j.map((function(t){return t.infoWindow.close()})),e.open(t,n)})),n.addListener("dragstart",(function(){e.close()})),n.addListener("dragend",(function(){var a=n.getPosition();e.setContent('<div id="map-popup">Fetching data...</div>'),e.open(t,n),c.setMap(null),R(a.lat(),a.lng())})),t.addListener("click",(function(t){b.current&&(b.current.value=""),R(t.latLng.lat(),t.latLng.lng())})),w.current.addEventListener("submit",(function(t){t.preventDefault();var n=w.current.querySelectorAll("input"),e={lat:parseFloat(n[0].value)||0,lng:parseFloat(n[1].value)||0};R(e.lat,e.lng)}))};return o.a.createElement("div",{className:"map-page"},o.a.createElement("div",{className:"map-container",ref:h}),o.a.createElement("div",{className:"map-search-bar"},o.a.createElement("div",{className:"map-search-option"},o.a.createElement("div",{onClick:function(){return I(!0)},className:S?"active":""},"Search by name"),o.a.createElement("div",{onClick:function(){return I(!1)},className:S?"":"active"},"Search by latlong")),o.a.createElement("input",{id:"map-search-name",ref:b,placeholder:"Search here...",style:{display:S?"inline-block":"none"}}),o.a.createElement("form",{ref:w,style:{display:S?"none":"block"}},o.a.createElement("input",{placeholder:"Latitude",value:E,onChange:function(t){return n=t.target.value,void(/^[0-9.-]*$/.test(n)&&x(n));var n}}),o.a.createElement("br",null),o.a.createElement("input",{placeholder:"Longitude",value:L,onChange:function(t){return n=t.target.value,void(/^[0-9.-]*$/.test(n)&&O(n));var n}}),o.a.createElement("button",{type:"submit"},"Search"))),o.a.createElement("div",{className:"map-find-me",onClick:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(n){var e=n.coords;b.current&&(b.current.value="");var a={lat:e.latitude,lng:e.longitude};t.setCenter(a),t.setZoom(17),R(e.latitude,e.longitude)}),(function(){alert("The Geolocation service failed.")})):alert("Your browser doesn't support geolocation.")}},o.a.createElement("img",{src:s.a,alt:"find_me"})),o.a.createElement("div",{className:"map-radius-slider"},o.a.createElement("input",{type:"range",ref:y,min:"100",max:"300",step:"25",value:F,onChange:function(t){T(t.target.value)}}),o.a.createElement("br",null),o.a.createElement("span",null,"Radius: ",F)))}}}]);
//# sourceMappingURL=2.bundle.js.map