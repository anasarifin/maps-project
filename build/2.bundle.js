(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{15:function(t,n,e){"use strict";n.a=e.p+"src/images/my_location.png"},43:function(t,n,e){var a=e(4),o=e(44);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var i={insert:"head",singleton:!1};a(o,i);t.exports=o.locals||{}},44:function(t,n,e){(n=e(5)(!1)).push([t.i,".map-page {\n\twidth: 100vw;\n\theight: 100vh;\n}\n.map-container {\n\twidth: 100%;\n\theight: 100%;\n}\n\n.map-search-bar {\n\tposition: fixed;\n\tmargin-top: 10px;\n\tmargin-left: 10px;\n\tmax-width: 200px;\n\twidth: 70%;\n\theight: max-content;\n\tbackground: white;\n\tborder-radius: 3px;\n}\n.map-search-option {\n\tbox-sizing: border-box;\n\tcursor: pointer;\n\tbackground-color: whitesmoke;\n\tcolor: gray;\n\tdisplay: grid;\n\tgrid-template-columns: 1fr 1fr;\n}\n.map-search-option div {\n\theight: 30px;\n\tline-height: 30px;\n\ttext-align: center;\n}\n.map-search-option div.active {\n\tbackground-color: white;\n\tcolor: black;\n}\n\n#map-search-name {\n\twidth: 100%;\n\tbox-sizing: border-box;\n}\n\n#map-popup {\n\twidth: max-content;\n\theight: max-content;\n}\n#map-popup span {\n\ttext-align: center;\n\tdisplay: block;\n}\n#map-popup-edit {\n\tmargin-top: 5px;\n\tcolor: blue;\n\tcursor: pointer;\n}\n\n#map-form {\n\tdisplay: grid;\n\tgrid-template-columns: 1fr;\n}\n#map-form label {\n\tdisplay: block;\n\tmargin: 5px;\n}\n#map-form button {\n\tmargin-top: 15px;\n}\n\n.map-input-bg {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 0;\n\theight: 0;\n\tbackground-color: rgba(0, 0, 0, 0.5);\n}\n.map-input-bg.show {\n\twidth: 100%;\n\theight: 100%;\n}\n.map-find-me {\n\tposition: fixed;\n\tbackground-color: white;\n\tmargin-right: 12px;\n}\n.map-radius-slider {\n\tbackground-color: white;\n\tposition: fixed;\n\tmargin-top: 10px;\n\tmargin-left: 10px;\n}\n#map-input-form {\n\tposition: fixed;\n\tdisplay: none;\n\tgrid-template-columns: 1fr;\n\tbackground-color: white;\n\tborder-radius: 5px;\n\tpadding: 15px;\n\ttop: 60%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\topacity: 0;\n\ttransition: 0.3s;\n}\n#map-input-form.show {\n\ttop: 50%;\n\topacity: 1;\n}\n#map-input-form input {\n\ttext-transform: uppercase;\n}\n#map-input-form label {\n\tdisplay: block;\n\tmargin: 7px;\n}\n#map-input-form button {\n\tmargin-top: 15px;\n}\n",""]),t.exports=n},47:function(t,n,e){"use strict";e.r(n);var a=e(0),o=e.n(a),i=e(16),r=e.n(i),c=e(25),l=e.n(c),s=(e(43),e(15));function p(t,n,e,a,o,i,r){try{var c=t[i](r),l=c.value}catch(t){return void e(t)}c.done?n(l):Promise.resolve(l).then(a,o)}function d(t){return function(){var n=this,e=arguments;return new Promise((function(a,o){var i=t.apply(n,e);function r(t){p(i,a,o,r,c,"next",t)}function c(t){p(i,a,o,r,c,"throw",t)}r(void 0)}))}}function u(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],a=!0,o=!1,i=void 0;try{for(var r,c=t[Symbol.iterator]();!(a=(r=c.next()).done)&&(e.push(r.value),!n||e.length!==n);a=!0);}catch(t){o=!0,i=t}finally{try{a||null==c.return||c.return()}finally{if(o)throw i}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return m(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return m(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,a=new Array(n);e<n;e++)a[e]=t[e];return a}var g=l()(r.a),f=l()(r.a),v={lat:-6.2088,lng:106.8456};n.default=function(){var t,n,e,i,c,l,p,m,h,w=Object(a.useRef)(null),b=Object(a.useRef)(null),y=Object(a.useRef)(null),x=Object(a.useRef)(null),k=u(Object(a.useState)(""),2),E=k[0],C=k[1],L=u(Object(a.useState)(""),2),O=L[0],M=L[1],P=u(Object(a.useState)("200"),2),F=P[0],T=P[1],D=u(Object(a.useState)(!0),2),I=D[0],S=D[1],j=[];Object(a.useEffect)((function(){var a=document.createElement("script");a.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyCXU3EeZo0yexMDnmkigGJJvTvcVDpgPl0","&libraries=places,geometry"),window.document.body.appendChild(a),a.addEventListener("load",d(regeneratorRuntime.mark((function a(){var o,r,s,d;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=new window.google.maps.Map(w.current,{zoom:15,center:v,clickableIcons:!1,fullscreenControl:!1,mapTypeControl:!0,gestureHandling:"greedy",mapTypeControlOptions:{position:window.google.maps.ControlPosition.BOTTOM_CENTER}}),n=new window.google.maps.Marker({map:t,draggable:!0,visible:!1}),e=new window.google.maps.InfoWindow,o=document.getElementById("map-search-name"),(l=new window.google.maps.places.Autocomplete(o,{fields:["geometry","name"],types:["geocode"],componentRestrictions:{country:["id"]}})).bindTo("bounds",t),i=new window.google.maps.Circle({map:t,strokeColor:"#FF0000",strokeOpacity:0,strokeWeight:0,fillColor:"#FF0000",fillOpacity:.2,clickable:!1}),c=new window.google.maps.Polygon({map:t,paths:[],strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.1,clickable:!1}),p=new window.google.maps.DirectionsService,m=new window.google.maps.DirectionsRenderer({suppressMarkers:!0,preserveViewport:!0}),h=new window.google.maps.DistanceMatrixService,r=document.getElementsByClassName("map-search-bar")[0],s=document.getElementsByClassName("map-find-me")[0],d=document.getElementsByClassName("map-radius-slider")[0],t.controls[window.google.maps.ControlPosition.TOP_LEFT].push(r),t.controls[window.google.maps.ControlPosition.RIGHT_BOTTOM].push(s),t.controls[window.google.maps.ControlPosition.TOP_LEFT].push(d),_();case 18:case"end":return a.stop()}}),a)}))))}),[]);var W=function a(o,l){j.map((function(t){return t.setMap(null)})),m&&m.setMap(null),n.setPosition({lat:o,lng:l}),n.setVisible(!0),e.setContent('<div id="map-popup">Fetching data...</div>'),e.open(t,n),c.setMap(null),i.setMap(null),i.setMap(t),i.setCenter({lat:o,lng:l}),i.setRadius(parseFloat(x.current.value)),g({url:"https://siis-api.udata.id/point_kelurahan/".concat(l,",").concat(o)}).then((function(n){var e=n.data.data[0].shape.slice(11,-2).split(", ").map((function(t){var n=t.split(" ");return{lat:parseFloat(n[1]),lng:parseFloat(n[0])}}));c.setPath(e),c.setMap(t);var a=document.getElementById("map-popup");if(a){var i=n.data.data[0],r=i.provinsi,s=i.kabupaten,p=i.kecamatan,d=i.kelurahan,u="\n\t\t\t\t<div>\n\t\t\t\t\t<span>".concat(r,"</span>\n\t\t\t\t\t<span>").concat(s,"</span>\n\t\t\t\t\t<span>").concat(p,"</span>\n\t\t\t\t\t<span>").concat(d,'</span><br/>\n\t\t\t\t\t<span id="map-popup-odp-loading">Fetching ODP data...</span>\n\t\t\t\t</div>');a.innerHTML="",a.insertAdjacentHTML("beforeend",u)}N(o,l)})).catch((function(t){if(!r.a.isCancel(t)){console.log(t);var o=document.getElementById("map-popup");o.innerHTML="",o.insertAdjacentHTML("beforeend",'\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div>Fetching failed !</div>\n\t\t\t\t\t\t<span id="map-popup-edit">Try again...</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t'),document.getElementById("map-popup-edit").addEventListener("click",(function(){e.setContent('<div id="map-popup">Fetching again...</div>');var t=n.getPosition();a(t.lat(),t.lng())}))}}))},N=function(a,o){f({url:"http://digitasi-consumer-siis-dev.vsan-apps.playcourt.id/api/siis/v1/get-odp",method:"post",data:{lat:a,long:o,radius:x.current.value},auth:{username:"telkom",password:"da1c25d8-37c8-41b1-afe2-42dd4825bfea"}}).then((function(i){var r=i.data.data.features.filter((function(t){return t.attributes.portidlenumber>0})),c=0;if(r.length){var l=r.map((function(t){return t.attributes.deviceportnumber})).reduce((function(t,n){return t+n})),s=r.map((function(t){return t.attributes.portidlenumber})).reduce((function(t,n){return t+n}));c=parseFloat((s/l*100).toFixed(1))}document.getElementById("map-popup-odp-loading").innerHTML="".concat(r.length," ODP found (").concat(c,"%)"),j=[],t.setCenter({lat:a,lng:o}),r.length&&t.setZoom(17),r.forEach((function(i,r){var c,l=i.attributes;switch(l.status_occ_add){case"RED":c="red";break;case"YELLOW":c="yellow";break;case"GREEN":c="green";break;default:c="black"}j.push(new window.google.maps.Marker({map:t,position:{lat:l.lat,lng:l.long},icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:6,fillColor:c,fillOpacity:.9,strokeWeight:0}})),j[r].latlng={lat:l.lat,lng:l.long},j[r].index=r,j[r].distance=window.google.maps.geometry.spherical.computeDistanceBetween(n.getPosition(),j[r].getPosition()),j[r].infoWindow=new window.google.maps.InfoWindow({content:"<div>\n\t\t\t\t\t\t<span>Latitude: ".concat(l.lat,"</span><br/>\n\t\t\t\t\t\t<span>Longitude: ").concat(l.long,"</span><br/>\n\t\t\t\t\t\t<span>Device ID: ").concat(l.device_id,"</span><br/>\n\t\t\t\t\t\t<span>Device name: ").concat(l.devicename,"</span><br/>\n\t\t\t\t\t\t<span>Status: ").concat(l.status_occ_add,"</span><br/>\n\t\t\t\t\t\t<span>Port number: ").concat(l.deviceportnumber,"</span><br/>\n\t\t\t\t\t\t<span>Idle port: ").concat(l.portidlenumber,"</span>\n\t\t\t\t\t</div>")}),j[r].addListener("mouseover",(function(){e.close(),j.map((function(t){return t.infoWindow.close()})),j[r].infoWindow.open(t,j[r])})),j[r].addListener("mouseout",(function(){j[r].infoWindow.close()})),j[r].addListener("click",(function(){e.close(),j.map((function(t){return t.infoWindow.close()})),j[r].infoWindow.open(t,j[r]),p.route({origin:"".concat(a,",").concat(o),destination:"".concat(l.lat,",").concat(l.long),travelMode:"WALKING"},(function(n,e){"OK"===e?(m.setMap(t),m.setDirections(n)):window.alert("Directions request failed due to "+e)}))}))}));var d=j.map((function(t){return{distance:t.distance,index:t.index,latlng:t.latlng}})).sort((function(t,n){return t.distance-n.distance})).filter((function(t,n){return n<3}));R(d)})).catch((function(t){r.a.isCancel(t)||(console.log(t),document.getElementById("map-popup-odp-loading").innerHTML="Fetching ODP failed!")}))},R=function(e){h.getDistanceMatrix({origins:[n.getPosition()],destinations:e.map((function(t){return new window.google.maps.LatLng(t.latlng.lat,t.latlng.lng)})),travelMode:"WALKING"},(function(n,a){"OK"===a?e.forEach((function(a,o){j[e[o].index].infoDistance=new window.google.maps.InfoWindow({content:"<div>\n\t\t\t\t\t\t\t<span>".concat(n.rows[0].elements[o].distance.value," m</span>\n\t\t\t\t\t\t</div>")}),j[e[o].index].infoDistance.open(t,j[e[o].index])})):window.alert("Distances request failed due to "+a)}))},_=function(){window.google.maps.event.addListener(l,"place_changed",(function(){var n=l.getPlace();if(n.geometry){var e=n.geometry,a=e.location;e.viewport?t.fitBounds(n.geometry.viewport):(t.setCenter(n.geometry.location),t.setZoom(16)),W(a.lat(),a.lng())}else alert("Quota exceeded!")})),n.addListener("click",(function(){e.getMap()||e.open(t,n)})),n.addListener("mouseover",(function(){j.map((function(t){return t.infoWindow.close()})),e.open(t,n)})),n.addListener("dragstart",(function(){e.close()})),n.addListener("dragend",(function(){var a=n.getPosition();e.setContent('<div id="map-popup">Fetching data...</div>'),e.open(t,n),c.setMap(null),W(a.lat(),a.lng())})),t.addListener("click",(function(t){b.current&&(b.current.value=""),W(t.latLng.lat(),t.latLng.lng())})),y.current.addEventListener("submit",(function(t){t.preventDefault();var n=y.current.querySelectorAll("input"),e={lat:parseFloat(n[0].value)||0,lng:parseFloat(n[1].value)||0};W(e.lat,e.lng)}))};return o.a.createElement("div",{className:"map-page"},o.a.createElement("div",{className:"map-container",ref:w}),o.a.createElement("div",{className:"map-search-bar"},o.a.createElement("div",{className:"map-search-option"},o.a.createElement("div",{onClick:function(){return S(!0)},className:I?"active":""},"Search by name"),o.a.createElement("div",{onClick:function(){return S(!1)},className:I?"":"active"},"Search by latlong")),o.a.createElement("input",{id:"map-search-name",ref:b,placeholder:"Search here...",style:{display:I?"inline-block":"none"}}),o.a.createElement("form",{ref:y,style:{display:I?"none":"block"}},o.a.createElement("input",{placeholder:"Latitude",value:E,onChange:function(t){return n=t.target.value,void(/^[0-9.-]*$/.test(n)&&C(n));var n}}),o.a.createElement("br",null),o.a.createElement("input",{placeholder:"Longitude",value:O,onChange:function(t){return n=t.target.value,void(/^[0-9.-]*$/.test(n)&&M(n));var n}}),o.a.createElement("button",{type:"submit"},"Search"))),o.a.createElement("div",{className:"map-find-me",onClick:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(n){var e=n.coords;b.current&&(b.current.value="");var a={lat:e.latitude,lng:e.longitude};t.setCenter(a),t.setZoom(17),W(e.latitude,e.longitude)}),(function(){alert("The Geolocation service failed.")})):alert("Your browser doesn't support geolocation.")}},o.a.createElement("img",{src:s.a,alt:"find_me"})),o.a.createElement("div",{className:"map-radius-slider"},o.a.createElement("input",{type:"range",ref:x,min:"100",max:"300",step:"25",value:F,onChange:function(t){T(t.target.value)}}),o.a.createElement("br",null),o.a.createElement("span",null,"Radius: ",F)))}}}]);
//# sourceMappingURL=2.bundle.js.map